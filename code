import java.io.FileInputStream;
import java.util.List;
import java.util.Map;

import org.yaml.snakeyaml.Yaml;

public class ExtractMetadata {
    public static void main(String[] args) throws Exception {
        // read YAML file
        Yaml yaml = new Yaml();
        FileInputStream inputStream = new FileInputStream("file.yaml");
        Iterable<Object> iterable = yaml.loadAll(inputStream);
        
        // iterate through YAML documents
        for (Object object : iterable) {
            Map<String, Object> document = (Map<String, Object>) object;
            
            // extract metadata:name
            Map<String, Object> metadata = (Map<String, Object>) document.get("metadata");
            String name = (String) metadata.get("name");
            
            // extract egress:ports
            Map<String, Object> spec = (Map<String, Object>) document.get("spec");
            List<Map<String, Object>> egressList = (List<Map<String, Object>>) spec.get("egress");
            for (Map<String, Object> egress : egressList) {
                List<Integer> ports = (List<Integer>) egress.get("ports");
                System.out.println("Metadata name: " + name + ", Egress ports: " + ports);
            }
        }
        
        inputStream.close();
    }
}




import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;
import org.yaml.snakeyaml.Yaml;
import java.util.Map;
import java.util.List;

public class YamlParser {
  public static void main(String[] args) {
    Yaml yaml = new Yaml();
    try {
      InputStream inputStream = new FileInputStream(new File("file.yaml"));
      Iterable<Object> itr = yaml.loadAll(inputStream);
      for (Object o : itr) {
        Map<String, Object> map = (Map<String, Object>) o;
        Map<String, Object> metadata = (Map<String, Object>) map.get("metadata");
        String name = (String) metadata.get("name");
        List<Map<String, Object>> egress = (List<Map<String, Object>>) ((Map<String, Object>) map.get("spec")).get("egress");
        for (Map<String, Object> e : egress) {
          Map<String, Object> destination = (Map<String, Object>) e.get("destination");
          List<String> ports = (List<String>) destination.get("ports");
          System.out.println("Name: " + name + ", Ports: " + ports);
        }
      }
    } catch (Exception e) {
      e.printStackTrace();
    }
  }
}
